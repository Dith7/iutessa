{% extends 'base.html' %}
{% load static %}

{% block title %}Contactez-Nous - IUTESSA{% endblock %}

{% block extra_css %}
<style>
    /* Form input styles */
    .contact-input {
        width: 100%;
        padding: 15px 20px;
        border: 1px solid #e5e5e5;
        border-radius: 4px;
        font-size: 15px;
        transition: border-color 0.3s ease;
        background: white;
    }
    
    .contact-input:focus {
        outline: none;
        border-color: #3db166;
    }
    
    .contact-input.error {
        border-color: #e74c3c;
    }
    
    /* Submit button loading animation */
    .submit-button {
        position: relative;
        overflow: hidden;
    }
    
    .submit-button.loading::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.3);
        animation: loading 1s infinite;
    }
    
    @keyframes loading {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    
    /* Map container */
    .map-container {
        position: relative;
        overflow: hidden;
        border-radius: 8px;
        height: 380px;
    }
    
    .map-container iframe {
        width: 100%;
        height: 100%;
        border: 0;
    }
    
    /* Success/Error messages */
    .form-message {
        padding: 15px 20px;
        border-radius: 4px;
        margin-bottom: 20px;
        display: none;
    }
    
    .form-message.show {
        display: block;
        animation: slideDown 0.3s ease;
    }
    
    .form-message.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    
    .form-message.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }
    
    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %}

{% block content %}

<!-- Hero Section with Background -->
<section class="relative bg-cover bg-center py-48" style="background-image: url('{% static 'images/contact-bg.jpg' %}');">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="relative max-w-[1140px] mx-auto px-4 text-center text-white">
        <h1 class="text-7xl font-bold mb-6">Contactez-Nous</h1>
        <p class="text-2xl uppercase tracking-widest">Entrer en Contact</p>
    </div>
</section>

<!-- Main Contact Section -->
<section class="bg-[#f5f5f5] py-16">
    <div class="max-w-[1140px] mx-auto px-4">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Contact Form (Left - 2/3) -->
            <div class="lg:w-2/3">
                <div class="bg-white p-12 rounded-lg shadow-md">
                    <h3 class="text-3xl font-bold text-[#192f59] mb-4">Laissez-nous vos Informations</h3>
                    <p class="text-gray-700 mb-8 leading-relaxed">
                        Une sérénité merveilleuse a pris possession de toute mon âme, comme ces douces matinées de printemps dont je jouis de tout mon cœur. Je suis seul et je ressens le charme de l'existence dans cet endroit.
                    </p>

                    <!-- Form Messages -->
                    <div id="successMessage" class="form-message success">
                        <i class="fas fa-check-circle mr-2"></i>
                        Votre message a été envoyé avec succès! Nous vous répondrons bientôt.
                    </div>
                    <div id="errorMessage" class="form-message error">
                        <i class="fas fa-exclamation-circle mr-2"></i>
                        Une erreur s'est produite. Veuillez réessayer.
                    </div>

                    <!-- Contact Form -->
                    <form id="contactForm" class="space-y-6">
                        {% csrf_token %}
                        <div>
                            <label for="name" class="block text-sm font-semibold text-gray-700 mb-2">
                                Votre Nom (requis)
                            </label>
                            <input 
                                type="text" 
                                id="name" 
                                name="name" 
                                class="contact-input" 
                                required
                            >
                            <span class="text-red-500 text-sm hidden" id="nameError">Veuillez entrer votre nom</span>
                        </div>

                        <div>
                            <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">
                                Votre Email (requis)
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="contact-input" 
                                required
                            >
                            <span class="text-red-500 text-sm hidden" id="emailError">Veuillez entrer un email valide</span>
                        </div>

                        <div>
                            <label for="subject" class="block text-sm font-semibold text-gray-700 mb-2">
                                Sujet
                            </label>
                            <input 
                                type="text" 
                                id="subject" 
                                name="subject" 
                                class="contact-input"
                            >
                        </div>

                        <div>
                            <label for="message" class="block text-sm font-semibold text-gray-700 mb-2">
                                Votre Message
                            </label>
                            <textarea 
                                id="message" 
                                name="message" 
                                rows="8" 
                                class="contact-input" 
                                required
                            ></textarea>
                            <span class="text-red-500 text-sm hidden" id="messageError">Veuillez entrer votre message</span>
                        </div>

                        <div>
                            <button 
                                type="submit" 
                                class="submit-button bg-[#3db166] hover:bg-[#35a05c] text-white px-12 py-4 rounded font-semibold transition-all duration-300 inline-flex items-center gap-3"
                            >
                                <span>Envoyer</span>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Contact Info & Map (Right - 1/3) -->
            <div class="lg:w-1/3">
                <div class="space-y-8">
                    <!-- Location Info -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-2xl font-bold text-[#192f59] mb-6">Localisation</h3>
                        <p class="text-gray-700 mb-6">
                            Campus IUTESSA
                            <br />Rue de l'Université
                            <br />Yaoundé, Cameroun
                        </p>
                        
                        <div class="space-y-4">
                            <div class="flex items-center gap-3 text-gray-700">
                                <i class="fas fa-envelope text-[#3db166] w-5"></i>
                                <a href="mailto:contact@iutessa.cm" class="hover:text-[#3db166] transition-colors">
                                    contact@iutessa.cm
                                </a>
                            </div>
                            <div class="flex items-center gap-3 text-gray-700">
                                <i class="fas fa-phone text-[#3db166] w-5"></i>
                                <a href="tel:+237678901234" class="hover:text-[#3db166] transition-colors">
                                    +237 6 78 90 12 34
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Map -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-2xl font-bold text-[#192f59] mb-6">Carte</h3>
                        <div class="map-container">
                            <iframe 
                                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d127363.90638456956!2d11.424707884375!3d3.8480325!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x108bcf7a309f0c75%3A0xc70ff788a8934ba!2sYaound%C3%A9%2C%20Cameroon!5e0!3m2!1sen!2s!4v1234567890123" 
                                allowfullscreen="" 
                                loading="lazy" 
                                referrerpolicy="no-referrer-when-downgrade"
                            ></iframe>
                        </div>
                    </div>

                    <!-- Office Hours -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-2xl font-bold text-[#192f59] mb-6">Heures d'Ouverture</h3>
                        <div class="space-y-3 text-gray-700">
                            <div class="flex justify-between">
                                <span class="font-semibold">Lundi - Vendredi:</span>
                                <span>8h00 - 17h00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Samedi:</span>
                                <span>9h00 - 13h00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Dimanche:</span>
                                <span class="text-red-500">Fermé</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Social Media Section -->
<section class="bg-white py-20">
    <div class="max-w-[1140px] mx-auto px-4">
        <div class="flex justify-center items-center gap-8 flex-wrap">
            <a href="mailto:contact@iutessa.cm" class="text-[#232323] hover:text-[#3db166] text-2xl transition-colors">
                <i class="fas fa-envelope"></i>
            </a>
            <a href="#" target="_blank" class="text-[#232323] hover:text-[#3b5998] text-2xl transition-colors">
                <i class="fab fa-facebook"></i>
            </a>
            <a href="#" target="_blank" class="text-[#232323] hover:text-[#1da1f2] text-2xl transition-colors">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="#" target="_blank" class="text-[#232323] hover:text-[#0077b5] text-2xl transition-colors">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="#" target="_blank" class="text-[#232323] hover:text-[#e4405f] text-2xl transition-colors">
                <i class="fab fa-instagram"></i>
            </a>
            <a href="#" target="_blank" class="text-[#232323] hover:text-[#ff0000] text-2xl transition-colors">
                <i class="fab fa-youtube"></i>
            </a>
            <a href="#" target="_blank" class="text-[#232323] hover:text-[#25d366] text-2xl transition-colors">
                <i class="fab fa-whatsapp"></i>
            </a>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
    // Form validation and submission
    document.getElementById('contactForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Reset error messages
        document.querySelectorAll('.contact-input').forEach(input => {
            input.classList.remove('error');
        });
        document.querySelectorAll('span[id$="Error"]').forEach(span => {
            span.classList.add('hidden');
        });
        
        // Get form values
        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const message = document.getElementById('message').value.trim();
        
        let isValid = true;
        
        // Validate name
        if (name === '') {
            document.getElementById('name').classList.add('error');
            document.getElementById('nameError').classList.remove('hidden');
            isValid = false;
        }
        
        // Validate email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (email === '' || !emailRegex.test(email)) {
            document.getElementById('email').classList.add('error');
            document.getElementById('emailError').classList.remove('hidden');
            isValid = false;
        }
        
        // Validate message
        if (message === '') {
            document.getElementById('message').classList.add('error');
            document.getElementById('messageError').classList.remove('hidden');
            isValid = false;
        }
        
        if (!isValid) {
            return;
        }
        
        // Show loading state
        const submitButton = document.querySelector('.submit-button');
        const originalText = submitButton.innerHTML;
        submitButton.disabled = true;
        submitButton.classList.add('loading');
        submitButton.innerHTML = '<span>Envoi en cours...</span><i class="fas fa-spinner fa-spin"></i>';
        
        // Simulate form submission (replace with actual AJAX call)
        setTimeout(() => {
            // Show success message
            document.getElementById('successMessage').classList.add('show');
            
            // Reset form
            document.getElementById('contactForm').reset();
            
            // Reset button
            submitButton.disabled = false;
            submitButton.classList.remove('loading');
            submitButton.innerHTML = originalText;
            
            // Hide success message after 5 seconds
            setTimeout(() => {
                document.getElementById('successMessage').classList.remove('show');
            }, 5000);
            
        }, 2000);
        
        // Uncomment below for actual Django form submission with AJAX
        /*
        const formData = new FormData(this);
        
        fetch('{% url "pages:contact" %}', {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('successMessage').classList.add('show');
                document.getElementById('contactForm').reset();
                setTimeout(() => {
                    document.getElementById('successMessage').classList.remove('show');
                }, 5000);
            } else {
                document.getElementById('errorMessage').classList.add('show');
                setTimeout(() => {
                    document.getElementById('errorMessage').classList.remove('show');
                }, 5000);
            }
        })
        .catch(error => {
            document.getElementById('errorMessage').classList.add('show');
            setTimeout(() => {
                document.getElementById('errorMessage').classList.remove('show');
            }, 5000);
        })
        .finally(() => {
            submitButton.disabled = false;
            submitButton.classList.remove('loading');
            submitButton.innerHTML = originalText;
        });
        */
    });
    
    // Remove error styling on input
    document.querySelectorAll('.contact-input').forEach(input => {
        input.addEventListener('input', function() {
            this.classList.remove('error');
            const errorSpan = document.getElementById(this.id + 'Error');
            if (errorSpan) {
                errorSpan.classList.add('hidden');
            }
        });
    });
</script>
{% endblock %}