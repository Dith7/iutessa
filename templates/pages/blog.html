{% extends 'base.html' %}
{% load static %}

{% block title %}Actualités - IUTESSA{% endblock %}

{% block extra_css %}
<style>
    /* Sticky badge */
    .sticky-badge {
        position: absolute;
        top: 20px;
        left: 20px;
        background: #3db166;
        color: white;
        padding: 8px 20px;
        border-radius: 4px;
        font-size: 13px;
        font-weight: 600;
        z-index: 10;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .blog-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .blog-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }
    
    .blog-image-wrap {
        position: relative;
        overflow: hidden;
    }
    
    .blog-image-wrap img {
        transition: transform 0.5s ease, opacity 0.3s ease;
    }
    
    .blog-image-wrap:hover img {
        transform: scale(1.1);
        opacity: 0.9;
    }
    
    .tag-cloud a {
        display: inline-block;
        padding: 6px 14px;
        margin: 4px;
        background: #f0f0f0;
        border-radius: 4px;
        text-decoration: none;
        color: #666;
        transition: all 0.3s ease;
        font-size: 13px;
    }
    
    .tag-cloud a:hover {
        background: #3db166;
        color: white;
    }
</style>
{% endblock %}

{% block content %}

<!-- Page Title -->
<section class="relative bg-[#192f59] py-16">
    <div class="max-w-[1140px] mx-auto px-4 text-white">
        <p class="text-sm uppercase tracking-wider mb-3">Actualités et Événements</p>
        <h1 class="text-5xl font-bold">Blog IUTESSA</h1>
    </div>
</section>

<!-- Main Content -->
<section class="bg-[#f7f7f7] py-16">
    <div class="max-w-[1140px] mx-auto px-4">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Articles (2/3) -->
            <div class="lg:w-2/3">
                <div class="space-y-10">
                    {% for post in posts %}
                    <article class="blog-card bg-white rounded-lg overflow-hidden shadow-md">
                        <div class="blog-image-wrap relative">
                            {% if forloop.first %}
                            <div class="sticky-badge">
                                <i class="fas fa-bolt"></i>
                                <span>Article Récent</span>
                            </div>
                            {% endif %}
                            <a href="{{ post.get_absolute_url }}">
                                {% if post.featured_image %}
                                <img src="{{ post.featured_image.url }}" alt="{{ post.title }}" class="w-full h-[400px] object-cover">
                                {% else %}
                                <div class="w-full h-[400px] bg-gray-300 flex items-center justify-center">
                                    <i class="fas fa-image text-gray-400 text-6xl"></i>
                                </div>
                                {% endif %}
                            </a>
                        </div>
                        <div class="p-10">
                            <h3 class="text-3xl font-bold text-[#192f59] mb-4 hover:text-[#3db166] transition-colors">
                                <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                            </h3>
                            <div class="flex flex-wrap gap-4 text-sm text-gray-600 mb-6 pb-6 border-b border-gray-200">
                                <span><i class="far fa-calendar mr-2"></i>{{ post.published_at|date:"d F Y" }}</span>
                                <span><i class="far fa-user mr-2"></i>Par {{ post.author.get_full_name }}</span>
                                {% if post.category %}
                                <span><i class="far fa-folder mr-2"></i>{{ post.category.name }}</span>
                                {% endif %}
                                <span><i class="far fa-comments mr-2"></i>{{ post.comments.count }} Commentaire{{ post.comments.count|pluralize }}</span>
                            </div>
                            <p class="text-gray-700 leading-relaxed mb-6">
                                {{ post.excerpt }}
                            </p>
                            <a href="{{ post.get_absolute_url }}" class="inline-block bg-[#3db166] hover:bg-[#35a05c] text-white px-8 py-3 rounded font-semibold transition-colors">
                                Lire Plus
                            </a>
                        </div>
                    </article>
                    {% empty %}
                    <div class="bg-white rounded-lg p-12 text-center">
                        <i class="fas fa-newspaper text-6xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500 text-lg">Aucun article pour le moment.</p>
                    </div>
                    {% endfor %}
                </div>

                <!-- Pagination -->
                {% if posts.has_other_pages %}
                <div class="flex justify-center items-center gap-2 mt-12">
                    {% if posts.has_previous %}
                    <a href="?page={{ posts.previous_page_number }}" class="w-10 h-10 bg-white hover:bg-[#3db166] hover:text-white text-gray-700 rounded-full flex items-center justify-center transition-colors">
                        <i class="fas fa-arrow-left"></i>
                    </a>
                    {% endif %}
                    
                    {% for num in posts.paginator.page_range %}
                    {% if posts.number == num %}
                    <span class="w-10 h-10 bg-[#3db166] text-white rounded-full flex items-center justify-center font-semibold">{{ num }}</span>
                    {% else %}
                    <a href="?page={{ num }}" class="w-10 h-10 bg-white hover:bg-[#3db166] hover:text-white text-gray-700 rounded-full flex items-center justify-center font-semibold transition-colors">{{ num }}</a>
                    {% endif %}
                    {% endfor %}
                    
                    {% if posts.has_next %}
                    <a href="?page={{ posts.next_page_number }}" class="w-10 h-10 bg-white hover:bg-[#3db166] hover:text-white text-gray-700 rounded-full flex items-center justify-center transition-colors">
                        <i class="fas fa-arrow-right"></i>
                    </a>
                    {% endif %}
                </div>
                {% endif %}
            </div>

            <!-- Sidebar (1/3) -->
            <aside class="lg:w-1/3">
                <div class="space-y-10">
                    <!-- À Propos -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-[#192f59] mb-6 pb-4 border-b-2 border-[#3db166]">À Propos</h3>
                        <p class="text-gray-700 leading-relaxed">
                            IUTESSA est un institut universitaire d'excellence dédié à la formation de la prochaine génération de leaders africains. Découvrez nos actualités et événements.
                        </p>
                    </div>

                    <!-- Articles Récents -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-[#192f59] mb-6 pb-4 border-b-2 border-[#3db166]">Articles Récents</h3>
                        <div class="space-y-6">
                            {% for recent in recent_posts %}
                            <div class="flex gap-4">
                                {% if recent.featured_image %}
                                <img src="{{ recent.featured_image.url }}" alt="" class="w-20 h-20 object-cover rounded flex-shrink-0">
                                {% else %}
                                <div class="w-20 h-20 bg-gray-200 rounded flex-shrink-0 flex items-center justify-center">
                                    <i class="fas fa-image text-gray-400"></i>
                                </div>
                                {% endif %}
                                <div>
                                    <h4 class="text-sm font-semibold text-[#192f59] hover:text-[#3db166] mb-2 leading-tight">
                                        <a href="{{ recent.get_absolute_url }}">{{ recent.title|truncatewords:8 }}</a>
                                    </h4>
                                    <div class="text-xs text-gray-600">
                                        <span class="block">{{ recent.published_at|date:"d M Y" }}</span>
                                        <span>Par {{ recent.author.get_full_name }}</span>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Catégories -->
                    <div class="bg-white p-8 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-[#192f59] mb-6 pb-4 border-b-2 border-[#3db166]">Catégories</h3>
                        <div class="tag-cloud">
                            {% for category in categories %}
                            <a href="?category={{ category.slug }}">{{ category.name }}</a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>
</section>

{% endblock %}