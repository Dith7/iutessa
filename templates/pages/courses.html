{% extends 'base.html' %}
{% load static %}

{% block title %}Nos Cours - IUTESSA{% endblock %}

{% block extra_css %}
<style>
    .course-item {
        display: flex;
        align-items: center;
        padding: 18px 25px;
        border-bottom: 1px solid #e5e5e5;
        transition: all 0.3s ease;
        background: white;
    }
    
    .course-item:hover {
        background: #f9f9f9;
        padding-left: 35px;
    }
    
    .course-item:hover .course-arrow {
        transform: translateX(5px);
        color: #3db166;
    }
    
    .course-code {
        font-weight: 600;
        color: #3db166;
        margin-right: 20px;
        min-width: 80px;
        flex-shrink: 0;
    }
    
    .course-title {
        flex-grow: 1;
        color: #192f59;
        font-weight: 500;
    }
    
    .course-arrow {
        color: #192f59;
        transition: all 0.3s ease;
        margin-left: auto;
        padding-left: 15px;
    }

    .filiere-header {
        background: linear-gradient(135deg, #192f59 0%, #2a4575 100%);
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 30px;
    }
</style>
{% endblock %}

{% block content %}

<!-- Page Title Section -->
<section class="bg-[#f8f8f8] py-20">
    <div class="max-w-[1140px] mx-auto px-4">
        <p class="text-gray-600 mb-2">Formations</p>
        <h1 class="text-4xl font-bold text-[#192f59]">Liste des Cours par Filière</h1>
    </div>
</section>

<!-- Search Bar -->
<section class="bg-white py-6 border-b border-gray-200">
    <div class="max-w-[1140px] mx-auto px-4">
        <form method="get" class="flex gap-4">
            <input 
                type="text" 
                name="search" 
                value="{{ search }}"
                placeholder="Rechercher une filière..."
                class="flex-1 px-4 py-3 border border-gray-300 rounded focus:outline-none focus:border-[#3db166]"
            />
            <button 
                type="submit"
                class="bg-[#3db166] text-white px-8 py-3 rounded font-semibold hover:bg-[#35a05c] transition-colors"
            >
                <i class="fas fa-search mr-2"></i>Rechercher
            </button>
        </form>
    </div>
</section>

<!-- Main Content Area -->
<section class="bg-white py-16">
    <div class="max-w-[1140px] mx-auto px-4">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Main Content (Left Column) -->
            <div class="lg:w-2/3">
                {% if filieres %}
                    {% for filiere in filieres %}
                        {% if filiere.courses.all %}
                        <div class="mb-16">
                            <!-- Filiere Header -->
                            <div class="filiere-header">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <span class="inline-block bg-white/20 text-white px-4 py-1 rounded text-sm font-semibold mb-3">
                                            {{ filiere.code }}
                                        </span>
                                        <h2 class="text-3xl font-bold text-white">{{ filiere.nom }}</h2>
                                        <p class="text-gray-200 mt-2">
                                            {{ filiere.courses.all|length }} cours disponible{{ filiere.courses.all|length|pluralize }}
                                        </p>
                                    </div>
                                    <div class="text-right text-white">
                                        <p class="text-sm text-gray-200">Durée</p>
                                        <p class="text-2xl font-bold">{{ filiere.duree_formation }}</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Cours obligatoires -->
                            <div class="mb-10">
                                <h3 class="text-xl font-semibold text-[#192f59] mb-6 uppercase">Cours Obligatoires</h3>
                                <div class="bg-white border border-gray-200 rounded">
                                    {% for course in filiere.courses.all %}
                                        {% if course.is_required %}
                                        <a href="{% url 'pages:course_detail' course.slug %}" class="course-item">
                                            <span class="course-code">{{ course.code|default:"—" }}</span>
                                            <span class="course-title">{{ course.title }}</span>
                                            <i class="fas fa-long-arrow-right course-arrow"></i>
                                        </a>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>

                            <!-- Cours électifs -->
                            <div class="mb-10">
                                <h3 class="text-xl font-semibold text-[#192f59] mb-6 uppercase">Cours Électifs</h3>
                                <div class="bg-white border border-gray-200 rounded">
                                    {% for course in filiere.courses.all %}
                                        {% if not course.is_required %}
                                        <a href="{% url 'pages:course_detail' course.slug %}" class="course-item">
                                            <span class="course-code">{{ course.code|default:"—" }}</span>
                                            <span class="course-title">{{ course.title }}</span>
                                            <i class="fas fa-long-arrow-right course-arrow"></i>
                                        </a>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <div class="text-center py-20">
                        <i class="fas fa-book-open text-gray-300 text-6xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-700 mb-2">Aucun cours disponible</h3>
                        <p class="text-gray-500">Les cours seront ajoutés prochainement.</p>
                    </div>
                {% endif %}
            </div>

            <!-- Sidebar (Right Column) -->
            <div class="lg:w-1/3">
                <div class="bg-[#192f59] text-white p-8 rounded sticky top-24">
                    <!-- Contact Info -->
                    <h3 class="text-xl font-bold mb-6">Informations</h3>
                    
                    <p class="text-[#3db166] font-semibold mb-2">
                        Direction des Études
                    </p>
                    
                    <p class="text-sm mb-6 leading-relaxed">
                        Campus IUTESSA<br>
                        Rue de l'Université<br>
                        Yaoundé, Cameroun
                    </p>
                    
                    <p class="text-sm mb-2">
                        <i class="fas fa-phone mr-2 text-[#3db166]"></i>
                        +237 6 XX XX XX XX
                    </p>
                    
                    <p class="text-sm mb-6">
                        <i class="fas fa-envelope mr-2 text-[#3db166]"></i>
                        info@iutessa.cm
                    </p>
                    
                    <p class="text-[#3db166] mb-8">
                        <i class="fas fa-clock mr-2"></i>
                        Lun – Ven 8h00 – 17h00
                    </p>
                    
                    <!-- Stats -->
                    <div class="border-t border-white/20 pt-6 mb-8">
                        <h3 class="text-xl font-bold mb-4">Statistiques</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-300">Filières actives</span>
                                <span class="font-bold text-[#3db166]">{{ filieres.count }}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Total cours</span>
                                <span class="font-bold text-[#3db166]">
                                    {% with total=0 %}
                                        {% for filiere in filieres %}
                                            {% with total=total|add:filiere.courses.all|length %}
                                            {% endwith %}
                                        {% endfor %}
                                        {{ total }}
                                    {% endwith %}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Social -->
                    <div class="border-t border-white/20 pt-6 mb-8">
                        <h3 class="text-xl font-bold mb-4">Réseaux Sociaux</h3>
                        <div class="flex gap-3">
                            <a href="#" class="text-[#3db166] hover:text-white transition-colors text-lg">
                                <i class="fab fa-facebook"></i>
                            </a>
                            <a href="#" class="text-[#3db166] hover:text-white transition-colors text-lg">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="#" class="text-[#3db166] hover:text-white transition-colors text-lg">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="text-[#3db166] hover:text-white transition-colors text-lg">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- CTA Button -->
                    <a 
                        href="{% url 'pages:apply' %}" 
                        class="block text-center bg-gradient-to-r from-[#3db166] to-[#35a05c] hover:from-[#35a05c] hover:to-[#2d8f4e] text-white py-4 px-6 rounded font-semibold transition-all"
                    >
                        <i class="fas fa-user-plus mr-2"></i>
                        Postuler Maintenant
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
    document.querySelectorAll('.course-item').forEach(item => {
        item.addEventListener('click', function(e) {
            const arrow = this.querySelector('.course-arrow');
            if (arrow) {
                arrow.style.transform = 'translateX(10px)';
            }
        });
    });
</script>
{% endblock %}