<!-- templates/academique/admin/etudiant_detail.html -->
{% extends 'administration/base.html' %}

{% block title %}{{ etudiant.nom_complet }}{% endblock %}

{% block breadcrumb_items %}
<li><i class="fas fa-chevron-right text-gray-400 mx-2"></i></li>
<li class="text-gray-500">Académique</li>
<li><i class="fas fa-chevron-right text-gray-400 mx-2"></i></li>
<li><a href="{% url 'academique:admin_etudiants_list' %}" class="text-gray-500 hover:text-gray-700">Étudiants</a></li>
<li><i class="fas fa-chevron-right text-gray-400 mx-2"></i></li>
<li class="text-gray-500">{{ etudiant.nom_complet }}</li>
{% endblock %}

{% block content %}
<div class="mb-8">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-4xl font-bold text-gradient-iut mb-2">{{ etudiant.nom_complet }}</h1>
            <p class="text-lg text-gray-600">{{ etudiant.numero_matricule }}</p>
        </div>
        <div class="flex space-x-3">
            {% if etudiant.statut_validation == 'en_attente' %}
            <a href="{% url 'academique:admin_validate_inscription' etudiant.id %}?action=valider" 
               class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-smooth">
                <i class="fas fa-check mr-2"></i>Valider
            </a>
            {% endif %}
            <a href="{% url 'academique:admin_etudiants_list' %}" 
               class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-smooth">
                <i class="fas fa-arrow-left mr-2"></i>Retour
            </a>
        </div>
    </div>
</div>

<!-- Informations générales -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
    <div class="bg-white/90 backdrop-blur-xl rounded-3xl shadow-xl border border-green-100 p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Informations personnelles</h2>
        <div class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-sm font-medium text-gray-600">Nom</label>
                    <p class="text-gray-900 font-semibold">{{ etudiant.nom }}</p>
                </div>
                <div>
                    <label class="text-sm font-medium text-gray-600">Prénoms</label>
                    <p class="text-gray-900 font-semibold">{{ etudiant.prenoms }}</p>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-sm font-medium text-gray-600">CNI</label>
                    <p class="text-gray-900">{{ etudiant.cni }}</p>
                </div>
                <div>
                    <label class="text-sm font-medium text-gray-600">Téléphone</label>
                    <p class="text-gray-900">{{ etudiant.telephone }}</p>
                </div>
            </div>
            <div>
                <label class="text-sm font-medium text-gray-600">Email</label>
                <p class="text-gray-900">{{ etudiant.email_personnel }}</p>
            </div>
        </div>
    </div>
    
    <div class="bg-white/90 backdrop-blur-xl rounded-3xl shadow-xl border border-green-100 p-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Informations académiques</h2>
        <div class="space-y-4">
            <div>
                <label class="text-sm font-medium text-gray-600">Filière</label>
                <p class="text-gray-900 font-semibold">{{ etudiant.filiere.nom }}</p>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-sm font-medium text-gray-600">Statut inscription</label>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                        {% if etudiant.statut_inscription == 'confirme' %}bg-green-100 text-green-800
                        {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                        {{ etudiant.get_statut_inscription_display }}
                    </span>
                </div>
                <div>
                    <label class="text-sm font-medium text-gray-600">Statut validation</label>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                        {% if etudiant.statut_validation == 'valide' %}bg-green-100 text-green-800
                        {% elif etudiant.statut_validation == 'en_attente' %}bg-yellow-100 text-yellow-800
                        {% else %}bg-red-100 text-red-800{% endif %}">
                        {{ etudiant.get_statut_validation_display }}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Documents -->
<div class="bg-white/90 backdrop-blur-xl rounded-3xl shadow-xl border border-green-100 overflow-hidden">
    <div class="px-6 py-4 border-b border-green-100">
        <h2 class="text-2xl font-bold text-gray-900">Documents</h2>
        <p class="text-gray-600">{{ documents_stats.valides }}/{{ documents_stats.total }} validés</p>
    </div>
    
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-green-100">
            <thead class="bg-gradient-soft">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Type</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Statut</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Date</th>
                    <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase">Actions</th>
                </tr>
            </thead>
            <tbody class="bg-white/50 divide-y divide-green-100">
                {% for document in documents %}
                <tr>
                    <td class="px-6 py-4 text-sm text-gray-900">{{ document.get_type_document_display }}</td>
                    <td class="px-6 py-4 text-center">
                        {% if document.valide %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                            <i class="fas fa-check mr-1"></i>Validé
                        </span>
                        {% else %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                            <i class="fas fa-clock mr-1"></i>En attente
                        </span>
                        {% endif %}
                    </td>
                    <td class="px-6 py-4 text-center text-sm text-gray-500">{{ document.date_upload|date:"d/m/Y" }}</td>
                    <td class="px-6 py-4 text-center">
                        <a href="{{ document.fichier.url }}" target="_blank" 
                           class="text-blue-600 hover:text-blue-800 transition-smooth">
                            <i class="fas fa-eye"></i>
                        </a>
                        {% if not document.valide %}
                        <a href="{% url 'academique:admin_validate_document' document.id %}" 
                           class="ml-2 text-green-600 hover:text-green-800 transition-smooth">
                            <i class="fas fa-check"></i>
                        </a>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="px-6 py-8 text-center text-gray-500">
                        Aucun document téléchargé
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}